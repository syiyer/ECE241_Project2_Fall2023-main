<html>
<head>
<title>delivery_service.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #6aab73;}
.s5 { color: #7a7e85;}
.s6 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
delivery_service.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; 
UMass ECE 241 - Advanced Programming 
Project 2 - Fall 2023 
&quot;&quot;&quot;</span>
<span class="s2">import </span><span class="s1">sys</span>
<span class="s2">from </span><span class="s1">graph </span><span class="s2">import </span><span class="s1">Graph</span><span class="s3">, </span><span class="s1">Vertex</span>
<span class="s2">from </span><span class="s1">priority_queue </span><span class="s2">import </span><span class="s1">PriorityQueue</span>
<span class="s2">from </span><span class="s1">collections </span><span class="s2">import </span><span class="s1">deque</span>

<span class="s2">class </span><span class="s1">DeliveryService</span><span class="s3">:</span>
    <span class="s2">def </span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">) </span><span class="s1">-&gt; </span><span class="s2">None</span><span class="s3">:</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">city_map </span><span class="s3">= </span><span class="s2">None</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">MST </span><span class="s3">= </span><span class="s2">None</span>

    <span class="s2">def </span><span class="s1">buildMap</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">: </span><span class="s1">str</span><span class="s3">) </span><span class="s1">-&gt; </span><span class="s2">None</span><span class="s3">:</span>
        <span class="s1">file </span><span class="s3">= </span><span class="s1">open</span><span class="s3">(</span><span class="s1">filename</span><span class="s3">, </span><span class="s4">&quot;r&quot;</span><span class="s3">)  </span><span class="s5"># Opening filename arg in read mode</span>
        <span class="s1">lines </span><span class="s3">= </span><span class="s1">file</span><span class="s3">.</span><span class="s1">readlines</span><span class="s3">()  </span><span class="s5"># Creating list of lines from text</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">city_map </span><span class="s3">= </span><span class="s1">Graph</span><span class="s3">()  </span><span class="s5"># initialise graph of map</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">lines</span><span class="s3">:</span>
            <span class="s1">nums </span><span class="s3">= </span><span class="s1">line</span><span class="s3">.</span><span class="s1">split</span><span class="s3">(</span><span class="s4">&quot;|&quot;</span><span class="s3">)</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">.</span><span class="s1">addEdge</span><span class="s3">(</span><span class="s1">int</span><span class="s3">(</span><span class="s1">nums</span><span class="s3">[</span><span class="s6">0</span><span class="s3">]), </span><span class="s1">int</span><span class="s3">(</span><span class="s1">nums</span><span class="s3">[</span><span class="s6">1</span><span class="s3">]), </span><span class="s1">int</span><span class="s3">(</span><span class="s1">nums</span><span class="s3">[</span><span class="s6">2</span><span class="s3">]))</span>
            <span class="s5">#  Add corresponding vertices and edges</span>
        <span class="s1">file</span><span class="s3">.</span><span class="s1">close</span><span class="s3">()  </span><span class="s5"># close file</span>
        <span class="s2">pass</span>

    <span class="s2">def </span><span class="s1">isWithinServiceRange</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">restaurant</span><span class="s3">: </span><span class="s1">int</span><span class="s3">, </span><span class="s1">user</span><span class="s3">: </span><span class="s1">int</span><span class="s3">, </span><span class="s1">threshold</span><span class="s3">: </span><span class="s1">int</span><span class="s3">) </span><span class="s1">-&gt; bool</span><span class="s3">:</span>
        <span class="s1">v </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">restaurant</span><span class="s3">)  </span><span class="s5"># get vertex at id given</span>
        <span class="s1">location </span><span class="s3">= </span><span class="s2">False</span>
        <span class="s2">if </span><span class="s1">v </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s1">location</span>
        <span class="s1">visited </span><span class="s3">= []  </span><span class="s5"># initialise empty list for visited vertexes</span>
        <span class="s1">vertQueue </span><span class="s3">= </span><span class="s1">deque</span><span class="s3">([(</span><span class="s1">restaurant</span><span class="s3">, </span><span class="s6">0</span><span class="s3">)])  </span><span class="s5"># create deque starting at restaurant</span>
        <span class="s2">while </span><span class="s1">len</span><span class="s3">(</span><span class="s1">vertQueue</span><span class="s3">) &gt; </span><span class="s6">0</span><span class="s3">:  </span><span class="s5"># run while deque still has items</span>
            <span class="s1">currentVert</span><span class="s3">, </span><span class="s1">distance </span><span class="s3">= </span><span class="s1">vertQueue</span><span class="s3">.</span><span class="s1">popleft</span><span class="s3">()</span>
            <span class="s2">if </span><span class="s1">distance </span><span class="s3">&gt; </span><span class="s1">threshold</span><span class="s3">:</span>
                <span class="s5"># continue if corresponding distance is higher than threshold to check other paths</span>
                <span class="s2">continue</span>
            <span class="s2">if </span><span class="s1">currentVert </span><span class="s3">== </span><span class="s1">user </span><span class="s2">and </span><span class="s1">distance </span><span class="s3">&lt;= </span><span class="s1">threshold</span><span class="s3">:</span>
                <span class="s5">#  return service range is true when distance below threshold</span>
                <span class="s2">return True</span>
            <span class="s1">visited</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s1">currentVert</span><span class="s3">)  </span><span class="s5"># add each vertex visited to list</span>
            <span class="s2">for </span><span class="s1">nextVert </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">currentVert</span><span class="s3">).</span><span class="s1">getConnections</span><span class="s3">():</span>
                <span class="s2">if </span><span class="s1">nextVert</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">() </span><span class="s2">not in </span><span class="s1">visited</span><span class="s3">:  </span><span class="s5"># check if vertex has been visited</span>
                    <span class="s1">nextDistance </span><span class="s3">= </span><span class="s1">distance </span><span class="s3">+ </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">currentVert</span><span class="s3">).</span><span class="s1">getWeight</span><span class="s3">(</span><span class="s1">nextVert</span><span class="s3">)</span>
                    <span class="s5">#  get new distance</span>
                    <span class="s1">vertQueue</span><span class="s3">.</span><span class="s1">append</span><span class="s3">((</span><span class="s1">nextVert</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">(), </span><span class="s1">nextDistance</span><span class="s3">))</span>
                    <span class="s5">#  add new items to deque</span>
        <span class="s2">return </span><span class="s1">location</span>
        <span class="s2">pass</span>

    <span class="s2">def </span><span class="s1">buildMST</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">restaurant</span><span class="s3">: </span><span class="s1">int</span><span class="s3">) </span><span class="s1">-&gt; bool</span><span class="s3">:</span>
        <span class="s1">v </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">restaurant</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">MST </span><span class="s3">= </span><span class="s1">Graph</span><span class="s3">()  </span><span class="s5"># initialise new MST as graph</span>
        <span class="s1">pq </span><span class="s3">= </span><span class="s1">PriorityQueue</span><span class="s3">()  </span><span class="s5"># create priority queue instance</span>
        <span class="s1">v</span><span class="s3">.</span><span class="s1">setDistance</span><span class="s3">(</span><span class="s6">0</span><span class="s3">)</span>
        <span class="s1">pq</span><span class="s3">.</span><span class="s1">buildHeap</span><span class="s3">([(</span><span class="s1">v</span><span class="s3">.</span><span class="s1">getDistance</span><span class="s3">(), </span><span class="s1">v</span><span class="s3">) </span><span class="s2">for </span><span class="s1">v </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">])</span>
        <span class="s5"># create the priorityqueue based on the vertexes in the map</span>
        <span class="s1">visited </span><span class="s3">= []  </span><span class="s5"># initialise visited vertexes</span>
        <span class="s2">while not </span><span class="s1">pq</span><span class="s3">.</span><span class="s1">isEmpty</span><span class="s3">():</span>
            <span class="s1">currentVertex </span><span class="s3">= </span><span class="s1">pq</span><span class="s3">.</span><span class="s1">delMin</span><span class="s3">()  </span><span class="s5"># get current vertex based on pq</span>
            <span class="s2">if </span><span class="s1">currentVertex </span><span class="s2">not in </span><span class="s1">visited</span><span class="s3">:</span>
                <span class="s1">visited</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s1">currentVertex</span><span class="s3">)  </span><span class="s5"># add the current vertex to visited list</span>
                <span class="s2">if </span><span class="s1">currentVertex</span><span class="s3">.</span><span class="s1">getPred</span><span class="s3">() </span><span class="s2">is not None</span><span class="s3">:</span>
                    <span class="s1">pred </span><span class="s3">= </span><span class="s1">currentVertex</span><span class="s3">.</span><span class="s1">getPred</span><span class="s3">()  </span><span class="s5"># find predecessor of current vertex</span>
                    <span class="s1">self</span><span class="s3">.</span><span class="s1">MST</span><span class="s3">.</span><span class="s1">addEdge</span><span class="s3">(</span><span class="s1">currentVertex</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">(), </span><span class="s1">pred</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">(), </span><span class="s1">currentVertex</span><span class="s3">.</span><span class="s1">getWeight</span><span class="s3">(</span><span class="s1">pred</span><span class="s3">))</span>
                    <span class="s5">#  add new edge based on current vertex and predecessor</span>
                <span class="s2">for </span><span class="s1">nextVert </span><span class="s2">in </span><span class="s1">currentVertex</span><span class="s3">.</span><span class="s1">getConnections</span><span class="s3">():</span>
                    <span class="s1">newDist </span><span class="s3">= </span><span class="s1">currentVertex</span><span class="s3">.</span><span class="s1">getWeight</span><span class="s3">(</span><span class="s1">nextVert</span><span class="s3">)</span>
                    <span class="s5"># get new distance</span>
                    <span class="s2">if </span><span class="s1">nextVert </span><span class="s2">not in </span><span class="s1">visited </span><span class="s2">and </span><span class="s1">newDist </span><span class="s3">&lt; </span><span class="s1">nextVert</span><span class="s3">.</span><span class="s1">getDistance</span><span class="s3">():</span>
                        <span class="s1">nextVert</span><span class="s3">.</span><span class="s1">setDistance</span><span class="s3">(</span><span class="s1">newDist</span><span class="s3">)</span>
                        <span class="s5"># update distance</span>
                        <span class="s1">nextVert</span><span class="s3">.</span><span class="s1">setPred</span><span class="s3">(</span><span class="s1">currentVertex</span><span class="s3">)</span>
                        <span class="s5"># update predecessor</span>
                        <span class="s1">pq</span><span class="s3">.</span><span class="s1">decreaseKey</span><span class="s3">(</span><span class="s1">nextVert</span><span class="s3">, </span><span class="s1">newDist</span><span class="s3">)</span>
                        <span class="s5"># decrease key based on value</span>
        <span class="s2">pass</span>

    <span class="s2">def </span><span class="s1">minimalDeliveryTime</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">restaurant</span><span class="s3">: </span><span class="s1">int</span><span class="s3">, </span><span class="s1">user</span><span class="s3">: </span><span class="s1">int</span><span class="s3">) </span><span class="s1">-&gt; int</span><span class="s3">:</span>
        <span class="s1">v </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">MST</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">restaurant</span><span class="s3">)</span>
        <span class="s1">v1 </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">MST</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">user</span><span class="s3">)</span>
        <span class="s5"># get two vertexes at given ids</span>
        <span class="s1">time </span><span class="s3">= </span><span class="s6">0</span>
        <span class="s5"># initialise time as 0</span>
        <span class="s1">visited </span><span class="s3">= []</span>
        <span class="s5"># initialise empty list of vertexes</span>
        <span class="s2">if </span><span class="s1">v </span><span class="s2">is None or </span><span class="s1">v1 </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s3">-</span><span class="s6">1</span>
        <span class="s5"># return -1 for in the vertexes don't exist in map</span>
        <span class="s1">visited </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">minimalDeliveryTimeHelper</span><span class="s3">(</span><span class="s1">restaurant</span><span class="s3">, </span><span class="s1">user</span><span class="s3">, </span><span class="s1">visited</span><span class="s3">)</span>
        <span class="s5"># get outputted list of vertexes from helper</span>
        <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range</span><span class="s3">(</span><span class="s1">len</span><span class="s3">(</span><span class="s1">visited</span><span class="s3">)-</span><span class="s6">1</span><span class="s3">):</span>
            <span class="s1">time </span><span class="s3">+= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">MST</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">visited</span><span class="s3">[</span><span class="s1">i</span><span class="s3">]).</span><span class="s1">getWeight</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">MST</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">visited</span><span class="s3">[</span><span class="s1">i</span><span class="s3">+</span><span class="s6">1</span><span class="s3">]))</span>
            <span class="s5">#  get total time from MST and vertexes</span>
        <span class="s2">return </span><span class="s1">time</span>
        <span class="s2">pass</span>

    <span class="s2">def </span><span class="s1">minimalDeliveryTimeHelper</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">restaurant</span><span class="s3">: </span><span class="s1">int</span><span class="s3">, </span><span class="s1">user</span><span class="s3">: </span><span class="s1">int</span><span class="s3">, </span><span class="s1">visited</span><span class="s3">: </span><span class="s1">list</span><span class="s3">):</span>
        <span class="s1">visited</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s1">restaurant</span><span class="s3">)  </span><span class="s5"># add each visited vertex to list to keep track</span>
        <span class="s2">if </span><span class="s1">restaurant </span><span class="s3">== </span><span class="s1">user</span><span class="s3">:</span>
            <span class="s5"># return list of vertexes if delivery reached user</span>
            <span class="s2">return </span><span class="s1">visited</span>
        <span class="s1">v </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">MST</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">restaurant</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">nextVert </span><span class="s2">in </span><span class="s1">v</span><span class="s3">.</span><span class="s1">getConnections</span><span class="s3">():</span>
            <span class="s5"># go through connections vertex by vertex</span>
            <span class="s2">if </span><span class="s1">nextVert</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">() </span><span class="s2">not in </span><span class="s1">visited</span><span class="s3">:</span>
                <span class="s5"># check if vertex already been visited</span>
                <span class="s1">visited1 </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">minimalDeliveryTimeHelper</span><span class="s3">(</span><span class="s1">nextVert</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">(), </span><span class="s1">user</span><span class="s3">, </span><span class="s1">visited</span><span class="s3">)</span>
                <span class="s5"># initialise new list for recurse of function</span>
                <span class="s2">if </span><span class="s1">visited1</span><span class="s3">:</span>
                    <span class="s2">return </span><span class="s1">visited1</span>
                    <span class="s5"># return new list if existing</span>
        <span class="s1">visited</span><span class="s3">.</span><span class="s1">pop</span><span class="s3">()</span>
        <span class="s5"># take out value from visited list</span>

    <span class="s2">def </span><span class="s1">findDeliveryPath</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">restaurant</span><span class="s3">: </span><span class="s1">int</span><span class="s3">, </span><span class="s1">user</span><span class="s3">: </span><span class="s1">int</span><span class="s3">) </span><span class="s1">-&gt; str</span><span class="s3">:</span>
        <span class="s1">v </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">restaurant</span><span class="s3">)  </span><span class="s5"># retrieve vertex for restaurant</span>
        <span class="s1">v1 </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">user</span><span class="s3">)  </span><span class="s5"># retrieve vertex for user</span>
        <span class="s2">if </span><span class="s1">v </span><span class="s2">is None or </span><span class="s1">v1 </span><span class="s2">is None</span><span class="s3">:  </span><span class="s5"># return invalid if either vertex do not exist</span>
            <span class="s2">return </span><span class="s4">&quot;INVALID&quot;</span>
        <span class="s1">path</span><span class="s3">, </span><span class="s1">weight </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">findDeliveryPathHelper</span><span class="s3">(</span><span class="s1">restaurant</span><span class="s3">, </span><span class="s1">user</span><span class="s3">)</span>
        <span class="s5"># call helper function to get path and time for delivery</span>
        <span class="s2">if </span><span class="s1">path </span><span class="s2">is None</span><span class="s3">:  </span><span class="s5"># return not accessible if no path for delivery</span>
            <span class="s2">return </span><span class="s4">&quot;INVALID&quot;</span>
        <span class="s1">pathStr </span><span class="s3">= </span><span class="s4">&quot;-&gt;&quot;</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s1">str</span><span class="s3">(</span><span class="s1">v</span><span class="s3">) </span><span class="s2">for </span><span class="s1">v </span><span class="s2">in </span><span class="s1">path</span><span class="s3">) + </span><span class="s4">&quot;(&quot; </span><span class="s3">+ </span><span class="s1">str</span><span class="s3">(</span><span class="s1">weight</span><span class="s3">) + </span><span class="s4">&quot;)&quot;</span>
        <span class="s5">#  concatenate path of string of vertexes and total time for delivery</span>
        <span class="s2">return </span><span class="s1">pathStr</span>
        <span class="s2">pass</span>

    <span class="s2">def </span><span class="s1">findDeliveryPathHelper</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">restaurant</span><span class="s3">: </span><span class="s1">int</span><span class="s3">, </span><span class="s1">user</span><span class="s3">: </span><span class="s1">int</span><span class="s3">):</span>
        <span class="s1">vertQueue </span><span class="s3">= </span><span class="s1">PriorityQueue</span><span class="s3">()</span>
        <span class="s5"># initialise priority queue instance for vertexes</span>
        <span class="s1">distance </span><span class="s3">= {}</span>
        <span class="s5"># initialise empty dict for distances</span>
        <span class="s1">path </span><span class="s3">= {}</span>
        <span class="s5"># initialise empty dict for paths</span>
        <span class="s2">for </span><span class="s1">v </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">:</span>
            <span class="s1">distance</span><span class="s3">[</span><span class="s1">v</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">()] = </span><span class="s1">float</span><span class="s3">(</span><span class="s4">'inf'</span><span class="s3">)</span>
            <span class="s1">path</span><span class="s3">[</span><span class="s1">v</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">()] = []</span>
            <span class="s5"># fill both dicts with initial values</span>
        <span class="s1">realPath </span><span class="s3">= []</span>
        <span class="s5"># initialise empty list for actual path to user</span>
        <span class="s1">distance</span><span class="s3">[</span><span class="s1">restaurant</span><span class="s3">] = </span><span class="s6">0</span>
        <span class="s5"># initialise distance dict to restaurant as 0</span>
        <span class="s1">vertQueue</span><span class="s3">.</span><span class="s1">buildHeap</span><span class="s3">([(</span><span class="s1">distance</span><span class="s3">[</span><span class="s1">v</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">()], </span><span class="s1">v</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">()) </span><span class="s2">for </span><span class="s1">v </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">])</span>
        <span class="s5"># fill priority queue with corresponding initial values</span>
        <span class="s2">while not </span><span class="s1">vertQueue</span><span class="s3">.</span><span class="s1">isEmpty</span><span class="s3">():</span>
            <span class="s1">currentDistance</span><span class="s3">, </span><span class="s1">currentVert </span><span class="s3">= </span><span class="s1">vertQueue</span><span class="s3">.</span><span class="s1">delMin1</span><span class="s3">()</span>
            <span class="s5">#  retrieve corresponding values from priority queue</span>
            <span class="s2">for </span><span class="s1">nextVert </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">currentVert</span><span class="s3">).</span><span class="s1">getConnections</span><span class="s3">():</span>
                <span class="s5"># iterate item through item for connecting vertexes in current vertex</span>
                <span class="s1">newDistance </span><span class="s3">= </span><span class="s1">currentDistance </span><span class="s3">+ </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">currentVert</span><span class="s3">).</span><span class="s1">getWeight</span><span class="s3">(</span><span class="s1">nextVert</span><span class="s3">)</span>
                <span class="s5"># retrieve new distance from weight between vertexes</span>
                <span class="s2">if </span><span class="s1">newDistance </span><span class="s3">&lt; </span><span class="s1">distance</span><span class="s3">[</span><span class="s1">nextVert</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">()]:</span>
                    <span class="s5"># check if distance is less than distance already in dict</span>
                    <span class="s1">distance</span><span class="s3">[</span><span class="s1">nextVert</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">()] = </span><span class="s1">newDistance</span>
                    <span class="s5"># update new lower distance if lower</span>
                    <span class="s1">path</span><span class="s3">[</span><span class="s1">nextVert</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">()] = </span><span class="s1">path</span><span class="s3">[</span><span class="s1">currentVert</span><span class="s3">] + [</span><span class="s1">currentVert</span><span class="s3">]</span>
                    <span class="s5"># update new path for lower distance</span>
                    <span class="s1">vertQueue</span><span class="s3">.</span><span class="s1">decreaseKey</span><span class="s3">(</span><span class="s1">nextVert</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">(), </span><span class="s1">newDistance</span><span class="s3">)</span>
                    <span class="s5"># update priority queue for new values</span>
        <span class="s1">realPath </span><span class="s3">= </span><span class="s1">path</span><span class="s3">[</span><span class="s1">user</span><span class="s3">] + [</span><span class="s1">user</span><span class="s3">]</span>
        <span class="s5"># get correct list of vertexes to user from path dict</span>
        <span class="s1">time </span><span class="s3">= </span><span class="s1">distance</span><span class="s3">[</span><span class="s1">user</span><span class="s3">]</span>
        <span class="s5"># get correct total distance to user from distance dict</span>
        <span class="s2">return </span><span class="s1">realPath</span><span class="s3">, </span><span class="s1">time</span>

    <span class="s2">def </span><span class="s1">findDeliveryPathWithDelay</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">restaurant</span><span class="s3">: </span><span class="s1">int</span><span class="s3">, </span><span class="s1">user</span><span class="s3">: </span><span class="s1">int</span><span class="s3">, </span><span class="s1">delay_info</span><span class="s3">: </span><span class="s1">dict</span><span class="s3">[</span><span class="s1">int</span><span class="s3">, </span><span class="s1">int</span><span class="s3">]) </span><span class="s1">-&gt; str</span><span class="s3">:</span>
        <span class="s1">v </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">restaurant</span><span class="s3">)  </span><span class="s5"># retrieve vertex for restaurant</span>
        <span class="s1">v1 </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">user</span><span class="s3">)  </span><span class="s5"># retrieve vertex for user</span>
        <span class="s2">if </span><span class="s1">v </span><span class="s2">is None or </span><span class="s1">v1 </span><span class="s2">is None</span><span class="s3">:  </span><span class="s5"># return invalid if either vertex do not exist</span>
            <span class="s2">return </span><span class="s4">&quot;INVALID&quot;</span>
        <span class="s1">path</span><span class="s3">, </span><span class="s1">weight </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">findDeliveryPathWithDelayHelper</span><span class="s3">(</span><span class="s1">restaurant</span><span class="s3">, </span><span class="s1">user</span><span class="s3">, </span><span class="s1">delay_info</span><span class="s3">)</span>
        <span class="s5"># call helper function to get path and time for delivery</span>
        <span class="s2">if </span><span class="s1">path </span><span class="s2">is None</span><span class="s3">:  </span><span class="s5"># return not accessible if no path for delivery</span>
            <span class="s2">return </span><span class="s4">&quot;INVALID&quot;</span>
        <span class="s1">pathStr </span><span class="s3">= </span><span class="s4">&quot;-&gt;&quot;</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s1">str</span><span class="s3">(</span><span class="s1">v</span><span class="s3">) </span><span class="s2">for </span><span class="s1">v </span><span class="s2">in </span><span class="s1">path</span><span class="s3">) + </span><span class="s4">&quot;(&quot; </span><span class="s3">+ </span><span class="s1">str</span><span class="s3">(</span><span class="s1">weight</span><span class="s3">) + </span><span class="s4">&quot;)&quot;</span>
        <span class="s5">#  concatenate path of string of vertexes and total time for delivery</span>
        <span class="s2">return </span><span class="s1">pathStr</span>
        <span class="s2">pass</span>
    <span class="s2">def </span><span class="s1">findDeliveryPathWithDelayHelper</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">restaurant</span><span class="s3">: </span><span class="s1">int</span><span class="s3">, </span><span class="s1">user</span><span class="s3">: </span><span class="s1">int</span><span class="s3">, </span><span class="s1">delay_info</span><span class="s3">: </span><span class="s1">dict</span><span class="s3">[</span><span class="s1">int</span><span class="s3">, </span><span class="s1">int</span><span class="s3">]):</span>
        <span class="s1">vertQueue </span><span class="s3">= </span><span class="s1">PriorityQueue</span><span class="s3">()</span>
        <span class="s5"># initialise priority queue instance for vertexes</span>
        <span class="s1">distance </span><span class="s3">= {}</span>
        <span class="s5"># initialise empty dict for distances</span>
        <span class="s1">path </span><span class="s3">= {}</span>
        <span class="s5"># initialise empty dict for paths</span>
        <span class="s2">for </span><span class="s1">v </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">:</span>
            <span class="s1">distance</span><span class="s3">[</span><span class="s1">v</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">()] = </span><span class="s1">float</span><span class="s3">(</span><span class="s4">'inf'</span><span class="s3">)</span>
            <span class="s1">path</span><span class="s3">[</span><span class="s1">v</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">()] = []</span>
            <span class="s5"># fill both dicts with initial values</span>
        <span class="s1">realPath </span><span class="s3">= []</span>
        <span class="s5"># initialise empty list for actual path to user</span>
        <span class="s1">distance</span><span class="s3">[</span><span class="s1">restaurant</span><span class="s3">] = </span><span class="s6">0</span>
        <span class="s5"># initialise distance value to restaurant as 0</span>
        <span class="s1">vertQueue</span><span class="s3">.</span><span class="s1">buildHeap</span><span class="s3">([(</span><span class="s1">distance</span><span class="s3">[</span><span class="s1">v</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">()], </span><span class="s1">v</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">()) </span><span class="s2">for </span><span class="s1">v </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">])</span>
        <span class="s5"># fill priority queue with corresponding initial values</span>
        <span class="s2">while not </span><span class="s1">vertQueue</span><span class="s3">.</span><span class="s1">isEmpty</span><span class="s3">():</span>
            <span class="s1">currentDistance</span><span class="s3">, </span><span class="s1">currentVert </span><span class="s3">= </span><span class="s1">vertQueue</span><span class="s3">.</span><span class="s1">delMin1</span><span class="s3">()</span>
            <span class="s5">#  retrieve corresponding values from priority queue</span>
            <span class="s2">for </span><span class="s1">nextVert </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">currentVert</span><span class="s3">).</span><span class="s1">getConnections</span><span class="s3">():</span>
                <span class="s5"># iterate item through item for connecting vertexes in current vertex</span>
                <span class="s1">newDistance </span><span class="s3">= </span><span class="s1">currentDistance </span><span class="s3">+ </span><span class="s1">self</span><span class="s3">.</span><span class="s1">city_map</span><span class="s3">.</span><span class="s1">getVertex</span><span class="s3">(</span><span class="s1">currentVert</span><span class="s3">).</span><span class="s1">getWeight</span><span class="s3">(</span><span class="s1">nextVert</span><span class="s3">)</span>
                <span class="s5"># retrieve new distance from weight between vertexes</span>
                <span class="s1">newDistance </span><span class="s3">+= </span><span class="s1">delay_info</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s1">nextVert</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">(), </span><span class="s6">0</span><span class="s3">)</span>
                <span class="s5"># add additional delay time from information given</span>
                <span class="s2">if </span><span class="s1">newDistance </span><span class="s3">&lt; </span><span class="s1">distance</span><span class="s3">[</span><span class="s1">nextVert</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">()]:</span>
                    <span class="s5"># check if distance is less than distance already in dict</span>
                    <span class="s1">distance</span><span class="s3">[</span><span class="s1">nextVert</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">()] = </span><span class="s1">newDistance</span>
                    <span class="s5"># update new lower distance if lower</span>
                    <span class="s1">path</span><span class="s3">[</span><span class="s1">nextVert</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">()] = </span><span class="s1">path</span><span class="s3">[</span><span class="s1">currentVert</span><span class="s3">] + [</span><span class="s1">currentVert</span><span class="s3">]</span>
                    <span class="s5"># update new path for lower distance</span>
                    <span class="s1">vertQueue</span><span class="s3">.</span><span class="s1">decreaseKey</span><span class="s3">(</span><span class="s1">nextVert</span><span class="s3">.</span><span class="s1">getId</span><span class="s3">(), </span><span class="s1">newDistance</span><span class="s3">)</span>
                    <span class="s5"># update priority queue for new values</span>
        <span class="s1">realPath </span><span class="s3">= </span><span class="s1">path</span><span class="s3">[</span><span class="s1">user</span><span class="s3">] + [</span><span class="s1">user</span><span class="s3">]</span>
        <span class="s5"># get correct list of vertexes to user from path dict made</span>
        <span class="s1">time </span><span class="s3">= </span><span class="s1">distance</span><span class="s3">[</span><span class="s1">user</span><span class="s3">]</span>
        <span class="s5"># get correct total distance to user from distance dict</span>
        <span class="s2">return </span><span class="s1">realPath</span><span class="s3">, </span><span class="s1">time</span>

    <span class="s5">## DO NOT MODIFY CODE BELOW!</span>
    <span class="s3">@</span><span class="s1">staticmethod</span>
    <span class="s2">def </span><span class="s1">nodeEdgeWeight</span><span class="s3">(</span><span class="s1">v</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s1">sum</span><span class="s3">([</span><span class="s1">w </span><span class="s2">for </span><span class="s1">w </span><span class="s2">in </span><span class="s1">v</span><span class="s3">.</span><span class="s1">connectedTo</span><span class="s3">.</span><span class="s1">values</span><span class="s3">()])</span>

    <span class="s3">@</span><span class="s1">staticmethod</span>
    <span class="s2">def </span><span class="s1">totalEdgeWeight</span><span class="s3">(</span><span class="s1">g</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s1">sum</span><span class="s3">([</span><span class="s1">DeliveryService</span><span class="s3">.</span><span class="s1">nodeEdgeWeight</span><span class="s3">(</span><span class="s1">v</span><span class="s3">) </span><span class="s2">for </span><span class="s1">v </span><span class="s2">in </span><span class="s1">g</span><span class="s3">]) // </span><span class="s6">2</span>

    <span class="s3">@</span><span class="s1">staticmethod</span>
    <span class="s2">def </span><span class="s1">checkMST</span><span class="s3">(</span><span class="s1">g</span><span class="s3">):</span>
        <span class="s2">for </span><span class="s1">v </span><span class="s2">in </span><span class="s1">g</span><span class="s3">:</span>
            <span class="s1">v</span><span class="s3">.</span><span class="s1">color </span><span class="s3">= </span><span class="s4">'white'</span>

        <span class="s2">for </span><span class="s1">v </span><span class="s2">in </span><span class="s1">g</span><span class="s3">:</span>
            <span class="s2">if </span><span class="s1">v</span><span class="s3">.</span><span class="s1">color </span><span class="s3">== </span><span class="s4">'white' </span><span class="s2">and not </span><span class="s1">DeliveryService</span><span class="s3">.</span><span class="s1">DFS</span><span class="s3">(</span><span class="s1">g</span><span class="s3">, </span><span class="s1">v</span><span class="s3">):</span>
                <span class="s2">return </span><span class="s4">'Your MST contains circles'</span>
        <span class="s2">return </span><span class="s4">'MST'</span>

    <span class="s3">@</span><span class="s1">staticmethod</span>
    <span class="s2">def </span><span class="s1">DFS</span><span class="s3">(</span><span class="s1">g</span><span class="s3">, </span><span class="s1">v</span><span class="s3">):</span>
        <span class="s1">v</span><span class="s3">.</span><span class="s1">color </span><span class="s3">= </span><span class="s4">'gray'</span>
        <span class="s2">for </span><span class="s1">nextVertex </span><span class="s2">in </span><span class="s1">v</span><span class="s3">.</span><span class="s1">getConnections</span><span class="s3">():</span>
            <span class="s2">if </span><span class="s1">nextVertex</span><span class="s3">.</span><span class="s1">color </span><span class="s3">== </span><span class="s4">'white'</span><span class="s3">:</span>
                <span class="s2">if not </span><span class="s1">DeliveryService</span><span class="s3">.</span><span class="s1">DFS</span><span class="s3">(</span><span class="s1">g</span><span class="s3">, </span><span class="s1">nextVertex</span><span class="s3">):</span>
                    <span class="s2">return False</span>
            <span class="s2">elif </span><span class="s1">nextVertex</span><span class="s3">.</span><span class="s1">color </span><span class="s3">== </span><span class="s4">'black'</span><span class="s3">:</span>
                <span class="s2">return False</span>
        <span class="s1">v</span><span class="s3">.</span><span class="s1">color </span><span class="s3">= </span><span class="s4">'black'</span>
        <span class="s2">return True</span>


<span class="s5"># NO MORE TESTING CODE BELOW!</span>
<span class="s5"># TO TEST YOUR CODE, MODIFY test_delivery_service.py</span>
</pre>
</body>
</html>